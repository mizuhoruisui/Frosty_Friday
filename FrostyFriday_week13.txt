select * from frosty_friday.week13.testing_data
order by PRODUCT,DATE_OF_CHECK;


---LAST_VALUE関数を使って解く

SELECT
    PRODUCT
    ,STOCK_AMOUNT
    ,LAST_VALUE(STOCK_AMOUNT IGNORE NULLS) OVER (PARTITION BY PRODUCT ORDER BY DATE_OF_CHECK
    ROWS  BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS STOCK_AMOUNT_FILLED_OUT
    ,DATE_OF_CHECK
FROM FROSTY_FRIDAY.WEEK13.TESTING_DATA
ORDER BY PRODUCT,DATE_OF_CHECK;



---COALESCE関数とLAG関数を使って解く

SELECT
    PRODUCT
    ,STOCK_AMOUNT
    ,COALESCE(STOCK_AMOUNT,LAG(STOCK_AMOUNT) IGNORE NULLS
    OVER (PARTITION BY PRODUCT ORDER BY DATE_OF_CHECK)) AS STOCK_AMOUNT_FILLED_OUT
    ,DATE_OF_CHECK
FROM FROSTY_FRIDAY.WEEK13.TESTING_DATA
ORDER BY PRODUCT,DATE_OF_CHECK;
